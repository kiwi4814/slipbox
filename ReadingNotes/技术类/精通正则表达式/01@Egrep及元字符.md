+++
title = "精通正则表达式"
date = 2022-05-17 17:29:42
slug = "/egrep"
draft = false
tags = ["阅读笔记","正则表达式"]
categories = ["阅读笔记"]
series = ["精通正则表达式"]
toc = true

+++

本文为《精通正则表达式》的阅读笔记。



## Egrep介绍





## Egrep元字符

下面介绍一下Egrep的一些元字符。

### 1. 行的起始与结束

用脱字符号`^`和美元符号`$`来代表一行的开始与结束，这里要注意的是**正则表达式是按照行进行匹配的**，也就是以换行符为界的匹配方式。（自己的理解，存疑）

### 2. 字符组

#### 2.1 匹配若干字符之一

使用中括号`[]`来匹配可能出现的字符组，他的意思是“或”。比如正则表达式`gr[ea]y`表示，先找一个g，跟着是一个r，然后是一个e或者a，最后是一个y。

**知识点：**

1. 字符组中匹配的字符是一个一个的，比如[123456]匹配的是数字1到6其中的一个

2. 在字符组`[]`内部，可以使用`-`表示字符的范围，比如`[0-9]`表示数字1到9，`[a-z]`表示字母a到z，并且允许多重范围，`[0-5a-fA-F]`等同于`[012345abcdefABCDEF]`
3. `-`只有在字符组内部才能被称为“元字符”，在`[]`之外就只能匹配普通的`-`符号，于此相反的是，点号`.`和问号`?`作为元字符，在字符组内部则不是如此，仅仅作为普通字符去匹配。比如说，`[0-9A-Z_?!.]`里面真正的特殊字符只有那两个连字符而已

#### 2.2 排除型字符组

`[...]`表示匹配一个可能出现的字符，而`[^...]`则表示匹配任何未列出的字符。（这里的...是省略号，里面是字符）。这里需要注意的是，脱字符`^`在字符组外部表示行的开始，但是在字符组内部表示“排除”，二者的含义是不一样的。



这里需要额外注意的是，**一个字符组，即使是排除型字符组，也需要匹配一个字符。**举例来说明，正则表达式`q[^u]`是无法匹配到Iraq的，因为q后面有换行符，而egrep默认会把这些换行符都去掉。（如果是其他软件，不去掉这个换行符的话，也是有可能匹配到的）。也就是说，排除型字符组表达并不是“只有当这个位置不是x时才能匹配”，而是“匹配一个不等于x的字符”。

### 3. 用点号匹配任意字符

元字符点号`.`是用来匹配任意字符的简便写法。比如我们可以用`03.19.76`来匹配03.19.76、03-19-76或者03/19/76，当然了，这种形式也能匹配到03319576这种不规则的数字等，这种情况下使用`03[-./]19[-./]76`能够更精确，当然了，实际使用中采取哪种方式要看你对匹配的文本的具体了解。



### 4. 多选结构（Alternation）

使用`|`来表达“或”的意思，多选结构可以包含很多字符，但是不能超过括号的界限。比如说`grey|gray`能够匹配grey或者gray，说明白点就是`|`的生效范围不止是`y|g`这部分，而是整个字符（直到遇到括号），上面例子的表达式`grey|gray`是等效于`gr(e|a)y`的。

#### 字符组和多选结构区别

- 一个字符组只能匹配目标文本中的单个字符，无论它多长；而多选结构本身中的每一个都是完整的正则表达式，可以匹配任意长度的文本
- 字符组本身就是一种微型语言（甚至对于元字符，字符组都有自己的规定），而多选结构是“正则表达式主体”的一部分

### 5. 忽略大小写

该功能并不是正则表达式语言的一部分，确实很多工具都提供的一个有用的特性，以egrep为例，使用`-i`参数来进行忽略大小写的匹配：

```she
% egrep -i '^(From|Subject|Date): ' mailbox
```

### 6. 单词分界符

单词识别，即匹配单词的开头和结束的位置。这里要用到元字符序列`\<`和`\>`，可以把他们想象为单词版本的脱字符号`^`和美元符号`$`。（注意只有某些版本的egrep才支持元字符序列）

![00014](https://kiwi4814-1256211473.cos.ap-nanjing.myqcloud.com//img202206072000637.jpeg)

### 7. 可选项元素

元字符「`?`」代表可选项，把它加在一个字符的后面，就表示此处允许出现这个字符，但是它的出现并非匹配成功的必要条件。与我们之前看到的连字符`-`不同，它只作用于紧邻着的元素，如果想要作用于多个元素，需要用括号`()`括起来。

### 8. 其他量词：重复出现

加号`+`和星号`*`的作用与问号`?`类似，都属于量词元字符。`+`表示“之前紧邻的元素出现一次或者多次”，而`*`表示“之前紧邻的元素出现任意多次，或者不出现”。



![00017](https://kiwi4814-1256211473.cos.ap-nanjing.myqcloud.com//img202206081156500.jpeg)

其实简单点理解，这三个量词能匹配到的区间分别是（其中0表达可以不出现，∞代表任意次数）：

- `?`: {0, 1} 可以不出现，也可以出现一次
- `+`: {0, ∞} 任意次数都可以匹配（即使不出现）
- `*`: {1, ∞} 至少出现一次



另外，某些版本的egrep能够自定义出现的次数，类似上面例子中的写法，其语法为`{min, max}`，当然了是不支持`∞`这种写法的。

### 9. 括号及反向引用



### 10. 神奇的转义









<iframe src="https://ip.skk.moe/simple" style="width: 100%; border: 0"></iframe>

