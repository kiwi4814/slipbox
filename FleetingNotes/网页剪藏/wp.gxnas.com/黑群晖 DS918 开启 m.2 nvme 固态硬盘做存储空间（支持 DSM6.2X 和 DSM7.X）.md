> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [wp.gxnas.com](https://wp.gxnas.com/10083.html)

> 众所周知，官方群晖 DS918 + 可以用两条 m.2 nvme 固态硬盘做缓存盘，黑群晖也可以通过打补丁的方式支持用 m.2 nvme 固态硬盘做缓存盘。

       众所周知，官方群晖 DS918 + 可以用两条 m.2 nvme 固态硬盘做缓存盘，黑群晖也可以通过打补丁的方式支持用 m.2 nvme 固态硬盘做缓存盘。黑群晖其实还可以用 m.2 nvme 固态硬盘来做存储盘，在万兆网络里面可以提高内网复制文件的速度。本教程于 DS918-6.2.3 系统下测试通过。

一、黑群晖打 m.2 nvme 补丁（如果已经打过补丁，此步骤跳过）

1、如果 DSM 系统是 918-6.23 版本的，下载 Nvme 的补丁 libsynonvme.so.1（ [点我下载](https://wp.gxnas.com/wp-content/uploads/2020/02/libsynonvme.so.1)）到电脑 ；

2、把下载的文件复制到群晖的 /usr/lib64 目录下，，并设置成可执行的权限（此步骤需要用 root 权限）；

3、如果之前是 6.22 的版本，打过 6.2.2 的 nvme 补丁，需要进 /usr/local/etc/rc.d 文件夹，把 libNVMEpatch.sh 删除（如果没有打过上面的补丁，此步骤可以跳过）；

4、如果 DSM 系统是 918-7.X 版本的，需要先按照《[黑群晖 DS918-7.X 开启 NVME 缓存的方法](https://wp.gxnas.com/10930.html)》修改系统文件；

5、重启群晖，重启后在存储空间管理员—hdd/ssd，查看能否正确识别 nvme 固态硬盘。

二、创建 nvme 存储盘（以下操作，都需要用 root 权限）

1、输入命令查看 NVME 硬盘状态

```
ls /dev/nvme*
```

#此时会显示所有的 nvme 固态硬盘，第一个为 nvme0n1；

2、查看第一个 nvme 固态硬盘信息

```
fdisk -l /dev/nvme0n1
```

![](https://kiwi4814-1256211473.cos.ap-nanjing.myqcloud.com//img2.png)

3、创建分区

```
synopartition --part /dev/nvme0n1 12
```

#在第一块 NVME 的上创建分区

#输入 “Y”，确认

![](https://kiwi4814-1256211473.cos.ap-nanjing.myqcloud.com//img1.png)

4、查看刚刚创建的分区

```
fdisk -l /dev/nvme0n1
```

#查看第一块 NVME 的分区布局，没有问题

5、查看当前储存池情况，记一下最后一个存储池的数字（比如我的是 md2）

```
cat /proc/mdstat
```

![](https://kiwi4814-1256211473.cos.ap-nanjing.myqcloud.com//img3.png)

6、创建 NVME 存储池

```
mdadm --create /dev/md3 --level=1 --raid-devices=1 --force /dev/nvme0n1p3
```

#需要注意的是：需要在上一步骤显示的储存池数字基础上加 1，作为 nvme 的存储池（所以是 md3）

#输入 “y” 确认

![](https://kiwi4814-1256211473.cos.ap-nanjing.myqcloud.com//img4.png)

7、创建储存空间，btrfs 格式和 ext4 格式，只能二选一：

#创建 ext4 格式请输入以下命令

```
mkfs.ext4 -F /dev/md3
```

#创建 btrfs 格式请输入以下命令

```
mkfs.btrfs -f /dev/md3
```

8、重启群晖；

三、存储空间 2 就是 nvme 固态硬盘了，搞定！

![](https://kiwi4814-1256211473.cos.ap-nanjing.myqcloud.com//img5.png)

特别说明：

如果你的群晖版本是 DSM7.X 版本，需要先按照《[黑群晖 DS918-7.X 开启 NVME 缓存的方法](https://wp.gxnas.com/10930.html)》教程识别到 nvme，才可以敲命令建立存储。